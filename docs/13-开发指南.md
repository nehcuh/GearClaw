# 13 开发指南

## 1. 常用开发命令

### 1.1 构建

```bash
cargo build
cargo build -p gearclaw_core
cargo build -p gearclaw_cli
cargo build -p gearclaw_gateway
cargo build -p gearclaw_channels
```

### 1.2 运行

```bash
# CLI
cargo run -p gearclaw_cli

# 单次执行
cargo run -p gearclaw_cli -- run "your prompt"

# 生成配置样例
cargo run -p gearclaw_cli -- config-sample

# Gateway
cargo run -p gearclaw_cli -- gateway
```

### 1.3 测试与质量

```bash
cargo test
cargo fmt
cargo clippy
cargo update
```

## 2. 目录协作约定

1. 核心对外接口优先放在 `gearclaw_core` facade。  
2. 子系统实现优先放在对应子 crate。  
3. 协议与渠道扩展遵循现有抽象（`GatewayFrame`、`ChannelAdapter`）。  
4. 文档新增或调整必须同步更新 `docs/00-文档索引.md`。

## 3. 开发关注点

1. 工具安全策略变更要评估 allowlist 影响。  
2. 会话 id、文件路径等输入必须保持安全校验。  
3. 配置项新增需保证默认值与向后兼容。  
4. 涉及渠道/网关改动需补事件与方法联调。

## 4. 文档维护规范

1. 除根 `README.md` 外，文档统一放 `docs/`。  
2. 使用编号文件名，维持稳定阅读顺序。  
3. 架构、设计、扩展三份主干文档优先保持最新。  
4. 示例命令默认使用 workspace 真实命令路径。

## 5. 导航

- 上一篇：[`12-测试与验证.md`](./12-测试与验证.md)  
- 返回索引：[`00-文档索引.md`](./00-文档索引.md)
