# 12 测试与验证

## 1. 基础质量检查

```bash
cargo test
cargo fmt
cargo clippy
```

## 2. 分层验证建议

### 2.1 Core/CLI 冒烟

```bash
cargo run -p gearclaw_cli -- run "输出当前时间"
cargo run -p gearclaw_cli -- list-sessions
```

### 2.2 Memory 冒烟

```bash
cargo run -p gearclaw_cli -- memory sync
cargo run -p gearclaw_cli -- memory search "测试关键词"
```

### 2.3 Gateway 冒烟

```bash
cargo run -p gearclaw_cli -- gateway
```

验证：

1. WebSocket 能连接  
2. `health/status` 正常返回  
3. `send` 方法能正确路由

### 2.4 Discord 联调（可选）

```bash
export DISCORD_BOT_TOKEN="..."
cargo run -p gearclaw_cli -- gateway
```

验证：

1. 能收到 `MessageCreate`  
2. 能推送 `channel.message`  
3. 触发命中时 Agent 可回发结果

## 3. 回归检查顺序

1. 编译通过  
2. 单测通过  
3. 命令级冒烟通过  
4. 渠道联调通过（如启用）  
5. 文档与配置示例同步更新

## 4. 常见失败定位

1. API/embedding 失败：检查 key、endpoint、网络  
2. 权限错误：检查系统权限与 bot 权限  
3. 触发未命中：检查 `agent.triggers` 配置与频道键格式

## 5. 导航

- 上一篇：[`11-GUI桌面客户端.md`](./11-GUI桌面客户端.md)  
- 下一篇：[`13-开发指南.md`](./13-开发指南.md)
